\documentclass[a4paper,11pt]{article}
\usepackage{ads}

\begin{document}

\section{Об оффлайн деревьях поиска: нижняя граница времени работы, геометрическое представление}

\subsection{Основные определения и предваряющие результаты}

Пусть дано бинарное дерево поиска с $n$ ключами. Мы знаем последовательность запросов, которые зададим этому дереву: $P = \set{s_1,s_2,\ldots,s_m}$. В поисках ключей~$s_i$ мы будем бегать по дереву туда-сюда и в процессе спуска/подъёма пройдём через некоторые вершины, которые нам не нужны.

\newdefn{$E(P)$ — множество всех вершин, которые мы посетим в процессе поиска вершин с ключами из $P$. $E = P \cup X$, $X$ — множество «лишних» вершин.}

\newdefn{$\opt$ — минимальный размер $E(P)$ (обозначение множества $P$ будем опускать, и так по контексту ясно).}

\newdefn{Конечное множество $G \subset \br^2$ называется {\it\arbs,} если
     \begin{align*}
&	\forall\,a,b \in G\quad x(a)=x(b)\text{,\ \ либо\ \ }
		y(a)=y(b)\text{,\ \ либо} \\
&	\exists\text{ точка $c$ внутри прямоугольника, определённого $a$, $b$} \\
&	\text{(внутри или на границе).}
     \end{align*}}

\begin{theorem}[Доказана ранее]
	Рассмотрим последовательность запросов
	\begin{equation*}
		\set{(s_1,1),(s_2,2),\ldots,(s_m,m)} \subset \bz^2.
	\end{equation*}

	Надмножество этой последовательности может представлять из себя последовательность узлов, которые были посещены при поиске $s_1, \ldots, s_m$, в том и только том случае, если оно \arbs.
\end{theorem}

\input{figs/rectEx}

Далее мы будем рассматривать изображение последовательности запросов на плоскости, соответственно под множеством $P$ будем понимать $\set{(s_1,1),(s_2,2),\ldots,(s_m,m)}$, аналогично вторую координату приделаем к ключам вершин из множества $E$.

\newdefn{
	Пусть дано множество $P$ и его надмножество $E$. Два прямоугольника,
	определённых каждый двумя вершинами множества $P$,
	будем называть {\it независимыми,} если
\begin{enumerate}
	\item они оба не \arbs, то есть им не принадлежит ни одна точка из $E$,
	\item ни одна из вершин одного из этих прямоугольников не лежит во внутренности другого.
\end{enumerate}}

\subsection{Оценка снизу числа {\rm OPT}}

\newdefn{Будем говорить, что прямоугольник, определённый точками $(x_1, y_1)$, $(x_2, y_2)$, {\it имеет тип~«+»,} если $(x_1-x_2) \cdot (y_1-y_2) \ge 0$, иначе прямоугольник {\it имеет тип~«$-$\!»} (смотреть Рисунок~\ref{fig:recType}).}

\begin{figure} \centering
\tikz[scale=0.7]{
\begin{scope}[xshift=-3 cm]
	\defrect{(-1.5,-1)}{(1.5,1)}{ }{ }; \draw (0,0) node{$+$};
\end{scope}
\begin{scope}[xshift=3 cm]
	\defrect{(-1.5,1)}{(1.5,-1)}{ }{ }; \draw (0,0) node{$-$};
\end{scope}
}
\caption{Прямоугольники типа \tpl и типа \tmi.}
\label{fig:recType}
\end{figure}

\newdefn{$\maxind$ — наибольшее число попарно независимых прямоугольников, определённых точками из $P$. Соответственно, $\maxind_+$, $\maxind_-$ — наибольшие количества попарно независимых прямоугольников фиксированного типа.}

\begin{theorem} \label{thm:optFirstBound}
\begin{equation}
	\label{eq:optFirstBound}
	\opt\ \ge\ |P| + \frac{1}{2} \maxind.
\end{equation}
\end{theorem}

Прежде чем приступить к доказательству Теоремы~\ref{thm:optFirstBound}, докажем следующую лемму:

\begin{lemma} \label{lm:optPlusBound}
\begin{equation}
	\label{eq:optPlusBound}
	\opt_+(P)\ \ge\ |P| + \frac{1}{2} \maxind_+ (P).
\end{equation}
\end{lemma}

Здесь $\opt_+$ — количество точек в множестве $E(P)$, нужное для того, чтобы множество всех прямоугольников типа~\tpl было \arbs. Это более слабое условие.

Далее мы забываем о том, что множества точек, с которыми мы работаем, — это вообще говоря выходы какой-то процедуры поиска, и рассматриваем произвольные конечные множества точек на плоскости.

\begin{proof}[Доказательство Леммы~\ref{lm:optPlusBound}]
Пусть все координаты точек из $P$ различны (точки можно чуть-чуть пошевелить, чтобы это стало так и ничего больше не нарушилось). Рассмотрим максимальный набор попарно независимых \tpl-прямоугольников и самый широкий из них — пусть он определён точками $a$, $b$. Некоторые прямоугольники будут пересекать наш самый широкий прямоугольник, одной из их вершин может быть $a$ или $b$, либо их определяющие вершины будут лежать за границами самого широкого прмяоугольника, одна выше, одна ниже, смотреть Рисунок~\ref{fig:rectCases}.

\input{figs/optPlusBound}

\end{proof}

\end{document}